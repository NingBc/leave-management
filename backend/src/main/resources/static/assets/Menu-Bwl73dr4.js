import{_ as z,r as p,c as g,o as O,e as S,f as V,g as w,k as l,w as o,l as d,m as c,B as s,y as C,h as J,A,E as j,D as k}from"./index-CYhBYbOp.js";const q={class:"toolbar"},F={class:"dialog-footer"},G={__name:"Menu",setup(H){const f=p([]),r=p(!1),v=p("add"),n=p({id:null,parentId:0,menuName:"",path:"",icon:"",orderNum:1}),h=g(()=>v.value==="add"?"添加菜单":"编辑菜单"),_=async()=>{try{const t=await c.get("/system/menu/list");f.value=t}catch(t){console.error(t)}},y=(t,e=null)=>{v.value=t,t==="add"?n.value={id:null,parentId:e?e.id:0,menuName:"",path:"",icon:"",orderNum:1}:n.value={...e},r.value=!0},x=g(()=>{const t=[{id:0,menuName:"主类目",children:[]}],e=JSON.parse(JSON.stringify(f.value));return t[0].children=e,t}),B=async()=>{try{const t={...n.value};delete t.children,t.path&&!t.component&&(t.component=t.path.replace(/^\//,"")),v.value==="add"?(await c.post("/system/menu/add",t),k.success("菜单已添加")):(await c.put("/system/menu/update",t),k.success("菜单已更新")),r.value=!1,_()}catch(t){console.error(t)}},D=async t=>{try{await j.confirm("确定要删除该菜单吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await c.delete(`/system/menu/delete/${t.id}`),k.success("菜单已删除"),_()}catch(e){e!=="cancel"&&console.error(e)}};return O(()=>{_()}),(t,e)=>{const u=d("el-button"),i=d("el-table-column"),M=d("el-icon"),U=d("el-table"),$=d("el-tree-select"),m=d("el-form-item"),b=d("el-input"),I=d("el-input-number"),E=d("el-form"),T=d("el-dialog");return V(),S("div",null,[w("div",q,[e[9]||(e[9]=w("span",null,null,-1)),l(u,{type:"primary",onClick:e[0]||(e[0]=a=>y("add"))},{default:o(()=>[...e[8]||(e[8]=[s("添加菜单",-1)])]),_:1})]),l(U,{data:f.value,style:{width:"100%"},"row-key":"id",border:"","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}},{default:o(()=>[l(i,{prop:"menuName",label:"菜单名称",width:"200"}),l(i,{prop:"icon",label:"图标",width:"80",align:"center"},{default:o(a=>[a.row.icon?(V(),C(M,{key:0},{default:o(()=>[(V(),C(A(a.row.icon)))]),_:2},1024)):J("",!0)]),_:1}),l(i,{prop:"orderNum",label:"排序",width:"80",align:"center"}),l(i,{prop:"path",label:"路由地址"}),l(i,{label:"操作",width:"250",fixed:"right"},{default:o(a=>[l(u,{link:"",type:"primary",size:"small",onClick:N=>y("add",a.row)},{default:o(()=>[...e[10]||(e[10]=[s("新增下级",-1)])]),_:1},8,["onClick"]),l(u,{link:"",type:"primary",size:"small",onClick:N=>y("edit",a.row)},{default:o(()=>[...e[11]||(e[11]=[s("编辑",-1)])]),_:1},8,["onClick"]),l(u,{link:"",type:"danger",size:"small",onClick:N=>D(a.row)},{default:o(()=>[...e[12]||(e[12]=[s("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),l(T,{modelValue:r.value,"onUpdate:modelValue":e[7]||(e[7]=a=>r.value=a),title:h.value,width:"600px"},{footer:o(()=>[w("span",F,[l(u,{onClick:e[6]||(e[6]=a=>r.value=!1)},{default:o(()=>[...e[13]||(e[13]=[s("取消",-1)])]),_:1}),l(u,{type:"primary",onClick:B},{default:o(()=>[...e[14]||(e[14]=[s("确认",-1)])]),_:1})])]),default:o(()=>[l(E,{model:n.value,"label-width":"100px"},{default:o(()=>[l(m,{label:"上级菜单"},{default:o(()=>[l($,{modelValue:n.value.parentId,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.parentId=a),data:x.value,props:{label:"menuName",value:"id",children:"children"},"check-strictly":"",placeholder:"选择上级菜单",style:{width:"100%"}},null,8,["modelValue","data"])]),_:1}),l(m,{label:"菜单名称"},{default:o(()=>[l(b,{modelValue:n.value.menuName,"onUpdate:modelValue":e[2]||(e[2]=a=>n.value.menuName=a),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),l(m,{label:"显示排序"},{default:o(()=>[l(I,{modelValue:n.value.orderNum,"onUpdate:modelValue":e[3]||(e[3]=a=>n.value.orderNum=a),min:0},null,8,["modelValue"])]),_:1}),l(m,{label:"路由地址"},{default:o(()=>[l(b,{modelValue:n.value.path,"onUpdate:modelValue":e[4]||(e[4]=a=>n.value.path=a),placeholder:"请输入路由地址"},null,8,["modelValue"])]),_:1}),l(m,{label:"图标"},{default:o(()=>[l(b,{modelValue:n.value.icon,"onUpdate:modelValue":e[5]||(e[5]=a=>n.value.icon=a),placeholder:"请输入图标名称 (如: Menu)"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},L=z(G,[["__scopeId","data-v-50ba56e1"]]);export{L as default};
